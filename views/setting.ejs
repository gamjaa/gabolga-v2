<%- include('header') %>
<div class="container">
    <h3>
        ì„¤ì •
        <small class="text-muted">ê°€ë³¼ê°€ì˜ ë™ì‘ì„ ì„¤ì •í•  ìˆ˜ ìˆì–´ìš”.</small>
    </h3>
    <% if (hasRefer) { %>
    <p>
        ê°€ë³¼ê°€ ì›¹ì‚¬ì´íŠ¸ì— ì²˜ìŒ ì˜¤ì…¨êµ°ìš”! ğŸ¤—<br>
        <% if (gabolgaCount) { %>
        ì´ë¯¸ 'ê°€ë³¼ê°€' í•˜ì‹  íŠ¸ìœ—ì´ <%= gabolgaCount %>ê°œë‚˜ ë˜ë„¤ìš”! ğŸ‘<br>
        <% } %>
        ì„¤ì •ì„ ë§ˆì¹˜ë©´ <%= req.session.screen_name %> ë‹˜ë§Œì˜ ì§€ë„ë¥¼ ë³´ì‹¤ ìˆ˜ ìˆì–´ìš”.<br>
        ê°€ë³¼ê°€ ê³„ì •ì„ íŒ”ë¡œìš° í•˜ì‹œë©´ ë” í¸ë¦¬í•˜ê²Œ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆë‹µë‹ˆë‹¤. ğŸ˜‰
    </p>
    <% } %>
    <form class="form" id="form" action="<%= req.originalUrl %>" method="post">
        <div class="form-group row">
            <label class="col-sm-2 control-label">ì•Œë¦¼ íŠ¸ìœ— ê²Œì‹œ</label>
            <div class="col-sm-10">
            <input type="checkbox" name="is_auto_tweet" <%= isAutoTweet ? 'checked' : '' %>>
            <small id="helpBlock" class="form-text text-muted">ê°€ë³¼ê°€ì— ìƒˆë¡œìš´ ì¥ì†Œë¥¼ ë“±ë¡í–ˆì„ ë•Œ, ìì‹ ì˜ ê³„ì •ì— íŠ¸ìœ—ì„ ê²Œì‹œí•´ìš”.</small>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-sm-2 control-label">ë“±ë¡ì ìµëª… í‘œì‹œ</label>
            <div class="col-sm-10">
            <input type="checkbox" name="is_anonymous" <%= isAnonymous ? 'checked' : '' %>>
            <small id="helpBlock" class="form-text text-muted">(ì¶”í›„ ì‚¬ìš© ì˜ˆì •) ì§ì ‘ ë“±ë¡í•œ ì¥ì†Œ í˜ì´ì§€ì—ì„œ ë“±ë¡ìë¥¼ ìµëª…ìœ¼ë¡œ í‘œì‹œí•´ìš”.</small>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-sm-2 control-label">ê°€ë³¼ê°€ íŒ”ë¡œìš°</label>
            <div class="col-sm-10">
            <a href="https://twitter.com/intent/followt?screen_name=GABOLGA_bot" class="twitter-follow-button" data-lang="ko" data-size="large" data-related="GABOLGA_bot" data-dnt="true">Follow @GABOLGA_bot</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            <small id="helpBlock" class="form-text text-muted">ê°€ë³¼ê°€ ê³„ì •ì„ íŒ”ë¡œìš°í•˜ë©´ ë” í¸ë¦¬í•˜ê²Œ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆì–´ìš”.</small>
            </div>
        </div>

        <div class="form-group row">
            <label class="col-sm-2 control-label">í•˜ê³ ì‹¶ì€ ë§ì€</label>
            <div class="col-sm-10">
            <a href="https://twitter.com/intent/tweet?screen_name=GABOLGA_bot" class="twitter-mention-button" data-lang="ko" data-size="large" data-related="GABOLGA_bot" data-dnt="true">Tweet to @GABOLGA_bot</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            <small id="helpBlock" class="form-text text-muted">ë˜ëŠ” <a href="https://twitter.com/_gamjaa" target="_blank">@_gamjaa</a> ê³„ì •ì— DMìœ¼ë¡œ ë³´ë‚´ì…”ë„ ëœë‹µë‹ˆë‹¤.</small>
            </div>
        </div>

        <div class="form-group row">
            <div class="col-sm-offset-2 col-sm-10">
            <button class="btn btn-primary btn-lg" type="submit" data-loading-text="ì €ì¥ ì¤‘..." autocomplete="off" id="submit" onclick="gtag('event', 'ì„¤ì •ì €ì¥')">ì €ì¥<%= hasRefer ? ' í›„ ëŒì•„ê°€ê¸°' : '' %></button>
            </div>
        </div>
    </form>

    <hr>

    <div class="form-group row">
        <label class="col-sm-2 control-label"><%= req.session.screen_name %> ë‹˜ì˜ ê³„ì •</label>
        <div class="col-sm-10">
            <button class="btn btn-info" onclick="location.href = '/logout'">ë¡œê·¸ì•„ì›ƒ</button>
            <small id="helpBlock" class="form-text text-muted">ê°€ë³¼ê°€ì—ì„œ ë¡œê·¸ì•„ì›ƒ í•©ë‹ˆë‹¤.</small>
        </div>
    </div>
    

    <% if (req.session.user_id === '62192325') { %>
        <h3>ê´€ë¦¬ì ë©”ë‰´</h3>
        <div class="input-group">
            <input type="text" class="form-control" placeholder="twitter screen name" id="screen_name">
            <div class="input-group-append">
                <button class="btn btn-outline-primary" type="button" onclick="setMentionPermission(true)">í—ˆë½</button>
                <button class="btn btn-outline-danger" type="button" onclick="setMentionPermission(false)">ê±°ë¶€</button>
                <script>
                    const screenName = document.getElementById('screen_name');
                    screenName.oninput = () => {
                        screenName.value = screenName.value.replace(/[^0-9a-zA-Z_]/g, '');
                    };
                    function httpGet(url, callback) {
                        const http = new XMLHttpRequest();
                        http.open('GET', url, true);
                        http.onreadystatechange = function () {
                        if (http.readyState === 4 && typeof callback === 'function') {
                            callback(JSON.parse(http.responseText));
                        }
                        };
                        http.send();
                    }
                    const setMentionPermission = bool => {
                        httpGet(`/admin/mention-permission?screen_name=${screenName.value}${bool ? '' : '&is_denied=1'}`, ({result}) => {
                            alert(result);
                        });
                    };
                </script>
            </div>
        </div>
        <script>
        
        </script>
        <a href="/admin/tweet">íŠ¸ìœ— ìˆ˜ì • ìš”ì²­ ëª©ë¡</a>
    <% } %>
</div>
<script src="/js/bootstrap-switch.min.js"></script>
<script>
    $("[name='is_auto_tweet']").bootstrapSwitch();
    $("[name='is_anonymous']").bootstrapSwitch();
</script>
<%- include('footer') %>